name: ğŸš€ Gmail Test Sender

on:
  workflow_dispatch:  # æ‰‹å‹•è§¸ç™¼
  
jobs:
  send-test-email:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    - name: ğŸ Setup Python 3.11
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
        
    - name: ğŸ“¤ Send Test Email
      env:
        GMAIL_EMAIL: ${{ secrets.GMAIL_EMAIL }}
        APP_PASSWORD: ${{ secrets.APP_PASSWORD }}
        TO_EMAIL: ${{ secrets.TO_EMAIL }}
      run: |
        # âœ… ä¿®æ­£1: ç”Ÿæˆ config.jsonï¼ˆç”¨ä½ ç¾æœ‰æª”å DailySender.pyï¼‰
        cat > config.json << 'EOF'
        {
          "gmail_email": "${{ secrets.GMAIL_EMAIL }}",
          "app_password": "${{ secrets.APP_PASSWORD }}",
          "to_email": "${{ secrets.TO_EMAIL }}",
          "bcc_list": [],
          "subject": "ğŸ§ª GitHub Actions Test - $(date +%Y%m%d-%H%M)",
          "html_content": "<h2>âœ… ktcdonald123 Auto Test Success!</h2><p>From: ktcdonald123@gmail.com<br>Time: $(date)<br>Server: GitHub Actions</p>"
        }
        EOF
        
        # âœ… ä¿®æ­£2: ç”¨æ­£ç¢ºæª”åï¼ˆä½ æˆªåœ–é¡¯ç¤º DailySender.pyï¼‰
        python DailySender.py --config config.json
        
        echo "âœ… Config generated:"
        cat config.json
        
    - name: ğŸ“Š Final Status
      if: always()
      run: |
        echo "ğŸ“ All files:"
        ls -la
        echo "ğŸ“§ Config content:"
        cat config.json || echo "Config not found"
